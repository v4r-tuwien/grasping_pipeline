<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7.12.4. object_detector.CallObjectDetectorService &mdash; Grasping Pipeline 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=10e673fd" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=e031e9a9"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=35a8b989"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7.13. place" href="place.html" />
    <link rel="prev" title="7.12.3. object_detector.visualize_rois" href="object_detector.visualize_rois.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Grasping Pipeline
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">1. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../startup.html">2. Starting the grasping pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adding_new_estimators.html">3. Adding a new estimator or detector to the grasping pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adding_new_objects.html">4. Adding new objects to the grasping pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview_state_machine.html">5. Overview of the statemachine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../details_state_machine.html">6. Detailed Description of the state machine</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">7. API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="check_table_clean.html">7.1. check_table_clean</a></li>
<li class="toctree-l2"><a class="reference internal" href="collision_environment.html">7.2. collision_environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="direct_grasppose_estimator.html">7.3. direct_grasppose_estimator</a></li>
<li class="toctree-l2"><a class="reference internal" href="execute_grasp_action_server.html">7.4. execute_grasp_action_server</a></li>
<li class="toctree-l2"><a class="reference internal" href="find_table_planes.html">7.5. find_table_planes</a></li>
<li class="toctree-l2"><a class="reference internal" href="grasp_annotator.html">7.6. grasp_annotator</a></li>
<li class="toctree-l2"><a class="reference internal" href="grasp_method_selector.html">7.7. grasp_method_selector</a></li>
<li class="toctree-l2"><a class="reference internal" href="grasppose_estimator.html">7.8. grasppose_estimator</a></li>
<li class="toctree-l2"><a class="reference internal" href="hsr_wrapper.html">7.9. hsr_wrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="image_fetcher.html">7.10. image_fetcher</a></li>
<li class="toctree-l2"><a class="reference internal" href="moveit_wrapper.html">7.11. moveit_wrapper</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="object_detector.html">7.12. object_detector</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="object_detector.check_label_img.html">7.12.1. object_detector.check_label_img</a></li>
<li class="toctree-l3"><a class="reference internal" href="object_detector.visualize_label_image.html">7.12.2. object_detector.visualize_label_image</a></li>
<li class="toctree-l3"><a class="reference internal" href="object_detector.visualize_rois.html">7.12.3. object_detector.visualize_rois</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">7.12.4. object_detector.CallObjectDetectorService</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#object_detector.CallObjectDetectorService"><code class="docutils literal notranslate"><span class="pre">CallObjectDetectorService</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="place.html">7.13. place</a></li>
<li class="toctree-l2"><a class="reference internal" href="pose_estimator.html">7.14. pose_estimator</a></li>
<li class="toctree-l2"><a class="reference internal" href="robot_control.html">7.15. robot_control</a></li>
<li class="toctree-l2"><a class="reference internal" href="statemachine_components.html">7.16. statemachine_components</a></li>
<li class="toctree-l2"><a class="reference internal" href="statemachine_llm.html">7.17. statemachine_llm</a></li>
<li class="toctree-l2"><a class="reference internal" href="statemachine.html">7.18. statemachine</a></li>
<li class="toctree-l2"><a class="reference internal" href="userinput.html">7.19. userinput</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualizer.html">7.20. visualizer</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Grasping Pipeline</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html"><span class="section-number">7. </span>API</a></li>
          <li class="breadcrumb-item"><a href="object_detector.html"><span class="section-number">7.12. </span>object_detector</a></li>
      <li class="breadcrumb-item active"><span class="section-number">7.12.4. </span>object_detector.CallObjectDetectorService</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/object_detector.CallObjectDetectorService.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="object-detector-callobjectdetectorservice">
<h1><span class="section-number">7.12.4. </span>object_detector.CallObjectDetectorService<a class="headerlink" href="#object-detector-callobjectdetectorservice" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="object_detector.CallObjectDetectorService">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">object_detector.</span></span><span class="sig-name descname"><span class="pre">CallObjectDetectorService</span></span><a class="headerlink" href="#object_detector.CallObjectDetectorService" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Service that calls the object detector and returns the detected objects.</p>
<p>This service calls the object detector server and returns the detected objects.
It also visualizes the detected objects and publishes the visualization images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rgb</strong> (<em>sensor_msgs.msg.Image</em>) – RGB image of the scene</p></li>
<li><p><strong>depth</strong> (<em>sensor_msgs.msg.Image</em>) – Depth image of the scene</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="object_detector.CallObjectDetectorService.srv">
<span class="sig-name descname"><span class="pre">srv</span></span><a class="headerlink" href="#object_detector.CallObjectDetectorService.srv" title="Permalink to this definition"></a></dt>
<dd><p>This service. Calls the object detector when called</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rospy.Service</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="object_detector.CallObjectDetectorService.label_image_pub">
<span class="sig-name descname"><span class="pre">label_image_pub</span></span><a class="headerlink" href="#object_detector.CallObjectDetectorService.label_image_pub" title="Permalink to this definition"></a></dt>
<dd><p>Publisher for the label image visualization. This is only published if the
object detector returns a valid label image. If the object detector doesn’t return a
valid label image, the label image is generated from the bounding boxes.
The label image is visualized by coloring each object with a unique color.
The topic is ‘/grasping_pipeline/obj_det_label_image’.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rospy.Publisher</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="object_detector.CallObjectDetectorService.bb_image_pub">
<span class="sig-name descname"><span class="pre">bb_image_pub</span></span><a class="headerlink" href="#object_detector.CallObjectDetectorService.bb_image_pub" title="Permalink to this definition"></a></dt>
<dd><p>Publisher for the bounding box visualization. The bounding boxes are visualized by drawing
a rectangle around each object. The topic is ‘/grasping_pipeline/obj_det_bb_image’.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rospy.Publisher</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topic</strong> (<em>str</em>) – Name of the object detector topic. Loaded from the ‘grasping_pipeline/object_detector_topic’ parameter</p></li>
<li><p><strong>timeout</strong> (<em>int</em>) – Timeout duration for the object detector. Loaded from the ‘grasping_pipeline/timeout_duration’ parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mask_detections</strong> (<em>List[sensor_msgs.msg.Image]</em>) – List of masks for each detected object. Each mask is a binary image where the object
is white and the background is black.</p></li>
<li><p><strong>bb_detections</strong> (<em>List[sensor_msgs.msg.RegionOfInterest]</em>) – List of bounding boxes for each detected object. Each bounding box is a rectangle
that encloses the object.</p></li>
<li><p><strong>class_names</strong> (<em>List[str]</em>) – List of class names for each detected object.</p></li>
<li><p><strong>class_confidences</strong> (<em>List[float]</em>) – List of confidences for each detected object.</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="object_detector.CallObjectDetectorService.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#object_detector.CallObjectDetectorService.__init__" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#object_detector.CallObjectDetectorService.__init__" title="object_detector.CallObjectDetectorService.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#object_detector.CallObjectDetectorService.convert_label_img_to_2D_BB" title="object_detector.CallObjectDetectorService.convert_label_img_to_2D_BB"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_label_img_to_2D_BB</span></code></a>(label_img)</p></td>
<td><p>Converts the label image to 2D bounding boxes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#object_detector.CallObjectDetectorService.execute" title="object_detector.CallObjectDetectorService.execute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">execute</span></code></a>(req)</p></td>
<td><p>Calls the object detector and returns the detected objects.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#object_detector.CallObjectDetectorService.split_label_image_into_masks_np" title="object_detector.CallObjectDetectorService.split_label_image_into_masks_np"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_label_image_into_masks_np</span></code></a>(label_image)</p></td>
<td><p>Splits the label image into masks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#object_detector.CallObjectDetectorService.split_label_image_into_masks_ros" title="object_detector.CallObjectDetectorService.split_label_image_into_masks_ros"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_label_image_into_masks_ros</span></code></a>(label_image)</p></td>
<td><p>Splits the label image into masks.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="object_detector.CallObjectDetectorService.convert_label_img_to_2D_BB">
<span class="sig-name descname"><span class="pre">convert_label_img_to_2D_BB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_img</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#object_detector.CallObjectDetectorService.convert_label_img_to_2D_BB" title="Permalink to this definition"></a></dt>
<dd><p>Converts the label image to 2D bounding boxes.</p>
<p>Converts the label image to 2D bounding boxes. The bounding boxes are calculated by
finding the minimumand maximum row and column indices of each object in the label image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>label_img</strong> (<em>np.ndarray</em>) – The label image. Each object in the label image has to have a unique label.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of bounding boxes for each detected object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[sensor_msgs.msg.RegionOfInterest]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="object_detector.CallObjectDetectorService.execute">
<span class="sig-name descname"><span class="pre">execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">req</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#object_detector.CallObjectDetectorService.execute" title="Permalink to this definition"></a></dt>
<dd><p>Calls the object detector and returns the detected objects.</p>
<p>This function calls the object detector server and returns the detected objects.
It also visualizes the detected objects and publishes the visualization images.
It converts the label image from the object detector to masks if the label image is valid.
If no bounding boxes were passed by the object detector, it converts the label image to bounding boxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>req</strong> (<em>grasping_pipeline_msgs.srv.CallObjectDetectorRequest</em>) – Request containing the RGB and Depth images</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>rospy.ServiceException</strong> – If the object detector fails to detect objects or times out or if neither a valid label image
    nor bounding boxes were returned by the object detector.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Response containing the detected objects. The response contains the masks, bounding boxes,
class names and confidences for the detected objects.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>grasping_pipeline_msgs.srv.CallObjectDetectorResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="object_detector.CallObjectDetectorService.split_label_image_into_masks_np">
<span class="sig-name descname"><span class="pre">split_label_image_into_masks_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#object_detector.CallObjectDetectorService.split_label_image_into_masks_np" title="Permalink to this definition"></a></dt>
<dd><p>Splits the label image into masks.</p>
<p>Splits the label image into masks. Each mask is a binary image where the object
is white and the background is black.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>label_image</strong> (<em>np.ndarray</em>) – The label image. Each object in the label image has to have a unique label.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of masks for each detected object. The background pixels have a value of
0 and the object pixels have a value of != 0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="object_detector.CallObjectDetectorService.split_label_image_into_masks_ros">
<span class="sig-name descname"><span class="pre">split_label_image_into_masks_ros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_image</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#object_detector.CallObjectDetectorService.split_label_image_into_masks_ros" title="Permalink to this definition"></a></dt>
<dd><p>Splits the label image into masks.</p>
<p>Splits the label image into masks. Each mask is a binary image where the object
is white and the background is black.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>label_image</strong> (<em>sensor_msgs.msg.Image</em>) – The label image. Each object in the label image has to have a unique label.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of masks for each detected object. The background pixels have a value of
0 and the object pixels have a value of != 0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[sensor_msgs.msg.Image]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="object_detector.visualize_rois.html" class="btn btn-neutral float-left" title="7.12.3. object_detector.visualize_rois" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="place.html" class="btn btn-neutral float-right" title="7.13. place" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Alexander Haberl.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>